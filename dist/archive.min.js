"use strict";"on"==localStorage.darkmode&&document.querySelector("body").classList.add("dark-theme");var cardStorage=localStorage.cards?JSON.parse(localStorage.cards):[],key="CsZGAx8GwP1dlmWuflb94puYcOmdpaXP",sections=[];cardStorage.forEach(function(t){return sections.push(t.section)});var idArray=[];cardStorage.forEach(function(t){return idArray.push(t.id)});var categories=shortenArr(sections),ax=function(t){t="https://api.nytimes.com/svc/topstories/v2/".concat(t,".json?api-key=").concat(key);return axios(t,{mode:"cors"}).then(function(t){return t.data.results})};function shortenStr(t,e){return t.length<=e?t:t.substr(0,t.lastIndexOf(" ",e))}function shortenArr(t){var e=[];return t.forEach(function(t){e.includes(t)||e.push(t)}),e}categories.length||(document.querySelector("#main").innerHTML='<p class="ta-center">Sorry, nothing here..</p>'),categories.forEach(function(t){var a=document.createElement("section");a.classList.add("Section"),document.querySelector("#main").append(a),a.innerHTML+='\n    <div class="d-f gap-3 p-2  bt-1-ice ai-center">\n        <div class="Section__icon br-full d-f jc-center ai-center">\n            <img src="./assets/icn_surfing.svg" alt="Header Icon" class="w-auto">\n        </div>\n        <h2 class="Section__header">'.concat(t,'</h2>\n        <button class="ml-auto Section__btn show-hide"><i class="fas fa-chevron-down Section__chevron"></i></button>\n    </div>');var n=0,r=document.createElement("div");r.classList.add("Card__container"),a.append(r),ax(t).then(function(t){t.forEach(function(e){"admin"!=e.section&&idArray.includes(e.short_url)?(r.innerHTML+='\n                <article class="Card" id="'.concat(e.short_url,'"\n                data-section="').concat(a.querySelector(".Section__header").textContent,'">\n                    <button class="Card__btn Card__btn_delete"><i class="fas fa-trash fs-l text-snow"></i></button>\n                    <div class="Card__text  p-2">\n                        <img src="').concat(e.multimedia[0].url,'" class="Card__img">\n                        <div>\n                            <h3 class="Card__title">').concat(e.title,'</h3>\n                            <p class="Card__abstract">').concat(shortenStr(e.abstract,30),"...</p>\n                        </div>\n                    </div>\n                </article>"),n+=100,r.style.maxHeight="".concat(n,"px")):(cardStorage=cardStorage.filter(function(t){return e.short_url!=t.id}),localStorage.setItem("cards",JSON.stringify(cardStorage)))})}).catch(function(t){t.status&&(t=t.response,document.querySelector("#main").innerHTML='<p class="ta-center">\n                Error: '.concat(t.status.toString()," (").concat(t.statusText,")<br>\n                ").concat(429==t.status?"Please wait awhile before reloading the page..":"","\n            </p>"))})}),document.querySelector(".Main").addEventListener("touchstart",function(e){var a,n,r,o,s=e.target.parentElement,c=e.target.closest(".Card");s.classList.contains("Card__text")||s.parentElement.classList.contains("Card__text")?(s=e.target.closest(".Card__text"),a=Math.floor(e.touches[0].clientX),r=c.querySelector(".Card__btn"),o=r.offsetWidth,s.addEventListener("touchmove",function(t){(n=Math.floor(t.touches[0].clientX))<a&&a-o<n&&(s.style.transform="translateX(".concat(n-a,"px)"))}),s.addEventListener("touchend",function(){s.style.transform=n<a-o/3?"translateX(-".concat(o,"px)"):"translateX(0px)"}),r.onclick=function(){r.disabled=!0,cardStorage=cardStorage.filter(function(t){return c.id!=t.id}),localStorage.setItem("cards",JSON.stringify(cardStorage)),JSON.parse(localStorage.cards).length||(localStorage.removeItem("cards"),document.querySelector("#main").innerHTML='<p class="ta-center">Sorry, nothing here..</p>'),Toastify({className:"Toast_delete",text:"'".concat(shortenStr(c.querySelector(".Card__title").textContent,20),"...' was removed from archived."),duration:3e3,stopOnFocus:!1,gravity:"top",position:"center"}).showToast(),c.classList.add("del-animation"),c.style.pointerEvents="none";var t=c.closest(".Card__container");t.style.maxHeight="".concat(t.offsetHeight-100,"px"),setTimeout(function(){c.remove()},1200)}):s.classList.contains("show-hide")&&(s.onclick=function(){var t=e.target.closest(".Section").querySelector(".Card__container");"rotate(-90deg)"!=e.target.style.transform?(e.target.style.transform="rotate(-90deg)",t.style.pointerEvents="none",t.classList.remove("show-animation"),t.classList.add("hide-animation")):(e.target.style.transform="rotate(0deg)",t.style.pointerEvents="auto",t.classList.remove("hide-animation"),t.classList.add("show-animation"))})});