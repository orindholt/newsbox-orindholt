const key="CsZGAx8GwP1dlmWuflb94puYcOmdpaXP",categories=["health","sports","travel"],ax=t=>{t=`https://api.nytimes.com/svc/topstories/v2/${t}.json?api-key=`+key;return axios(t,{mode:"cors"}).then(t=>t.data.results)};function shortenStr(t,s){return t.length<=s?t:t.substr(0,t.lastIndexOf(" ",s))}categories.forEach(t=>{let e=document.createElement("section");e.classList.add("Section"),document.querySelector("#main").append(e),e.innerHTML+=`
    <div class="d-f gap-3 p-2 bb-1-ice bt-1-ice ai-center">
        <div class="Section__icon br-full d-f jc-center ai-center">
            <img src="./assets/icn_surfing.svg" alt="Header Icon" class="w-auto">
        </div>
        <h2 class="Section__header">${t}</h2>
        <button class="ml-auto Section__btn show-hide"><i class="fas fa-chevron-right"></i></button>
    </div>`,ax(t).then(t=>{t.forEach(s=>{if("admin"!=s.section){let t=document.createElement("article");t.classList.add("Card"),t.classList.add("hide-animation"),t.setAttribute("data-id",s.short_url),t.innerHTML+=`
                <button class="Card__btn bg-sage"><i class="fas fa-inbox fs-l text-snow"></i></button>
                <div class="Card__text bg-snow p-2">
                    <img src="${s.multimedia[0].url}" class="Card__img">
                    <div>
                        <h3 class="Card__title">${s.title}</h3>
                        <p class="Card__abstract">${shortenStr(s.abstract,30)}...</p>
                    </div>
                </div>`,e.append(t)}})})});
const cardStorage=localStorage.cards?JSON.parse(localStorage.cards):[];document.querySelector(".Main").addEventListener("touchstart",s=>{let o=s.target.parentElement,n=s.target.closest(".Card");if(o.classList.contains("Card__text")||o.parentElement.classList.contains("Card__text")){o=s.target.closest(".Card__text");let e=Math.floor(s.touches[0].clientX),a,t=n.querySelector(".Card__btn"),r=t.offsetWidth;o.addEventListener("touchmove",t=>{a=Math.floor(t.touches[0].clientX),a<e&&a>e-r&&(o.style.transform=`translateX(${a-e}px)`)}),o.addEventListener("touchend",()=>{a<e-r/3?o.style.transform=`translateX(-${r}px)`:o.style.transform="translateX(0px)"}),t.onclick=()=>{t.disabled=!0,cardStorage.push(n.getAttribute("data-id")),localStorage.cards=JSON.stringify(cardStorage),n.classList.add("del-animation"),n.style.pointerEvents="none",setTimeout(()=>{n.remove()},1200)}}else o.classList.contains("show-hide")&&(o.onclick=()=>{n=s.target.closest(".Section"),"rotate(90deg)"!=s.target.style.transform?(s.target.style.transform="rotate(90deg)",n.querySelectorAll(".Card").forEach(t=>{t.classList.remove("hide-animation"),t.style.pointerEvents="auto"})):(s.target.style.transform="rotate(0deg)",n.querySelectorAll(".Card").forEach(t=>{t.classList.add("hide-animation"),t.style.pointerEvents="none"}))})});