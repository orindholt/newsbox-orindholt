"use strict";var cardStorage=localStorage.cards?JSON.parse(localStorage.cards):[];"on"==localStorage.darkmode&&document.querySelector("body").classList.add("dark-theme"),localStorage.cards?document.querySelector(".Nav__inbox").setAttribute("data-text",cardStorage.length):document.querySelector(".Nav__inbox").setAttribute("data-text","0");var key="CsZGAx8GwP1dlmWuflb94puYcOmdpaXP",categories=["world","health","sports","business","travel"],idArray=[];cardStorage.forEach(function(t){return idArray.push(t.id)});var ax=function(t){t="https://api.nytimes.com/svc/topstories/v2/".concat(t,".json?api-key=").concat(key);return axios(t,{mode:"cors"}).then(function(t){return t.data.results})};function shortenStr(t,e){return t.length<=e?t:t.substr(0,t.lastIndexOf(" ",e))}categories.forEach(function(t){var e,a,n;"off"!=localStorage["".concat(t)]&&((e=document.createElement("section")).classList.add("Section"),document.querySelector("#main").append(e),e.innerHTML+='\n        <div class="d-f gap-3 p-2 ai-center">\n            <div class="Section__icon br-full d-f jc-center ai-center">\n                <img src="./assets/icn_surfing.svg" alt="Header Icon" class="w-auto">\n            </div>\n            <h2 class="Section__header">'.concat(t,'</h2>\n            <button class="ml-auto Section__btn show-hide"><i class="fas fa-chevron-down Section__chevron"></i></button>\n        </div>'),a=0,(n=document.createElement("div")).classList.add("Card__container"),e.append(n),ax(t).then(function(t){t.forEach(function(t){"admin"!=t.section&&!idArray.includes(t.short_url)&&t.multimedia&&t.abstract&&(n.innerHTML+='\n                    <article class="Card" id="'.concat(t.short_url,'"\n                    data-section="').concat(e.querySelector(".Section__header").textContent,'">\n                        <button class="Card__btn Card__btn_inbox"><i class="fas fa-inbox fs-l text-snow"></i></button>\n                        <div class="Card__text p-2">\n                            <img src="').concat(t.multimedia[0].url,'" class="Card__img">\n                            <div>\n                                <h3 class="Card__title">').concat(t.title,'</h3>\n                                <p class="Card__abstract">').concat(shortenStr(t.abstract,30),"...</p>\n                            </div>\n                        </div>\n                    </article>"),a+=100,n.style.maxHeight="".concat(a,"px"))})}).catch(function(t){t.status&&(t=t.response,document.querySelector("#main").innerHTML='<p class="ta-center">\n                    Error: '.concat(t.status.toString()," (").concat(t.statusText,")<br>\n                    ").concat(429==t.status?"Please wait awhile before reloading the page..":"","\n                </p>"))}))}),document.querySelector(".Main").addEventListener("touchstart",function(e){var a,n,o,r,s=e.target.parentElement,c=e.target.closest(".Card");s.classList.contains("Card__text")||s.parentElement.classList.contains("Card__text")?(s=e.target.closest(".Card__text"),a=Math.floor(e.touches[0].clientX),o=c.querySelector(".Card__btn"),r=o.offsetWidth,s.addEventListener("touchmove",function(t){(n=Math.floor(t.touches[0].clientX))<a&&a-r<n&&(s.style.transform="translateX(".concat(n-a,"px)"))}),s.addEventListener("touchend",function(){s.style.transform=n<a-r/3?"translateX(-".concat(r,"px)"):"translateX(0px)"}),o.onclick=function(){o.disabled=!0;var t={id:c.id,section:c.getAttribute("data-section")};cardStorage.push(t),localStorage.cards=JSON.stringify(cardStorage),document.querySelector(".Nav__inbox").setAttribute("data-text",cardStorage.length),Toastify({className:"Toast_save",text:"'".concat(shortenStr(c.querySelector(".Card__title").textContent,20),"...' was archived."),duration:3e3,stopOnFocus:!1,gravity:"top",position:"center"}).showToast(),c.classList.add("del-animation"),c.style.pointerEvents="none";t=c.closest(".Card__container");t.style.maxHeight="".concat(t.offsetHeight-100,"px"),setTimeout(function(){c.remove()},1200)}):s.classList.contains("show-hide")&&(s.onclick=function(){var t=e.target.closest(".Section").querySelector(".Card__container");"rotate(-90deg)"!=e.target.style.transform?(e.target.style.transform="rotate(-90deg)",t.style.pointerEvents="none",t.classList.remove("show-animation"),t.classList.add("hide-animation")):(e.target.style.transform="rotate(0deg)",t.style.pointerEvents="auto",t.classList.remove("hide-animation"),t.classList.add("show-animation"))})});